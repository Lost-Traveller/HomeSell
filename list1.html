<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Listing Planner | HomeSell</title>
  <!-- Friendly, modern font -->
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      font-family: 'Open Sans', Arial, sans-serif;
      background: #f4f8fb;
      color: #223;
    }
    /* Main Nav */
    .main-nav {
      display: flex;
      justify-content: flex-start;
      align-items: center;
      background: #1b4e8a;
      height: 60px;
      padding: 0 20px;
      gap: 0;
    }
    .main-nav a {
      color: #fff;
      font-family: 'Open Sans', Arial, sans-serif;
      font-size: 1.08em;
      font-weight: 600;
      padding: 0 25px;
      height: 60px;
      line-height: 60px;
      text-decoration: none;
      transition: background 0.2s, color 0.2s;
      border: none;
      background: none;
      display: inline-block;
    }
    .main-nav a:hover {
      background: #ff7f50;
      color: #fff;
    }
    .main-nav a.active {
      background: #68a6f6;
      color: #fff;
    }

    /* Subnav styles */
    .subnav {
      display: flex;
      align-items: center;
      background: #e4eefa;
      padding: 0 20px 8px 20px;
      gap: 10px;
    }
    .subnav a {
      font-family: 'Open Sans', Arial, sans-serif;
      font-size: 1em;
      font-weight: 500;
      text-decoration: none;
      padding: 8px 16px;
      background: #e4eefa;
      color: #1b4e8a;
      border-radius: 4px;
      border: none;
      transition: background 0.2s, color 0.2s;
      margin-top: 8px;
      margin-bottom: 2px;
      display: inline-block;
    }
    .subnav a:hover,
    .subnav a.active {
      background: #68a6f6;
      color: #fff;
    }

    .container {
      max-width: 950px;
      margin: 32px auto;
      padding: 20px;
    }
    h1 {
      font-size: 2.2em;
      color: #1b4e8a;
      margin-bottom: 10px;
    }
    .intro {
      font-size: 1.12em;
      margin-bottom: 20px;
      line-height: 1.5;
      color: #34495e;
    }
    /* Date controls & button */
    .date-controls {
      display: flex;
      flex-direction: column;
      margin-bottom: 30px;
    }
    .date-controls label {
      font-weight: 600;
      margin-bottom: 6px;
      color: #1b4e8a;
    }
    .date-controls input[type="date"] {
      padding: 8px;
      border: 1.5px solid #b9cfe7;
      border-radius: 4px;
      font-family: 'Open Sans', sans-serif;
      font-size: 1em;
      width: 250px;
    }
    .start-button {
      margin-top: 12px;
      padding: 10px 20px;
      background: #ff7f50;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }
    .start-button:hover {
      background: #ff9b73;
    }
    /* Calendar grid styles */
    #calendar {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 40px;
    }
    .calendar {
      flex: 1;
      min-width: 400px;
      background: #fff;
      border-radius: 6px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      padding: 10px;
    }
    .calendar h3 {
      margin-top: 0;
      background: #1b4e8a;
      color: #fff;
      padding: 8px;
      border-top-left-radius: 6px;
      border-top-right-radius: 6px;
      text-align: center;
      font-size: 1.2em;
      letter-spacing: 0.5px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th {
      background: #68a6f6;
      color: #fff;
      padding: 6px;
      font-weight: 600;
      font-size: 0.95em;
      text-align: center;
      letter-spacing: 0.2px;
    }
    td {
      border: 1px solid #ddd;
      height: 80px;
      padding: 4px;
      position: relative;
      vertical-align: top;
      text-align: left;
      background: #fff;
    }
    .date-num {
      font-weight: 600;
      font-size: 0.95em;
      color: #1b4e8a;
    }
    /* Orange dots for milestones, now with links and hover effect */
    .task-dot {
      position: absolute;
      top: 4px;
      right: 4px;
      width: 14px;
      height: 14px;
      background: #ff7f50;
      border-radius: 50%;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      border: 2px solid #fff;
      z-index: 2;
    }
    .task-dot:hover {
      transform: scale(1.2);
      box-shadow: 0 0 8px #ff7f50;
    }
    /* Tooltip for task dot */
    .dot-tooltip {
      display: none;
      position: absolute;
      top: 22px;
      right: 2px;
      background: #fff8f2;
      color: #1b4e8a;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 0.97em;
      font-weight: 500;
      box-shadow: 0 2px 10px #ff7f5016;
      z-index: 10;
      min-width: 150px;
      border: 1.5px solid #ff7f50;
    }
    .task-dot:focus + .dot-tooltip,
    .task-dot:hover + .dot-tooltip {
      display: block;
    }
    /* Milestone buttons & explanations */
    #milestones {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .milestone-btn {
      padding: 14px 18px;
      background: #e4eefa;
      border: none;
      border-radius: 4px;
      font-family: 'Open Sans', sans-serif;
      font-size: 1.07em;
      font-weight: 600;
      cursor: pointer;
      text-align: left;
      transition: background 0.2s, color 0.2s;
      color: #1b4e8a;
      box-shadow: 0 2px 10px rgba(0,0,0,0.03);
    }
    .milestone-btn:hover, .milestone-btn:focus {
      background: #68a6f6;
      color: #fff;
      outline: none;
    }
    #milestones h2 {
      color: #1b4e8a;
      margin-bottom: 14px;
    }
    @media(max-width: 850px){
      .calendar { min-width: 260px; }
      #calendar { flex-direction: column; }
    }
  </style>
</head>
<body>

<!-- Main Navigation -->
<div class="main-nav">
  <a href="index.html">Home</a>
  <a href="decide.html">Decide</a>
  <a href="prepare.html">Prepare</a>
  <a href="market.html">Market</a>
  <a href="list.html" class="active">List</a>
  <a href="openhome.html">OpenHome</a>
  <a href="negotiate.html">Negotiate</a>
  <a href="sell.html">Sell</a>
  <a href="move.html">Move</a>

</div>
<!-- Sub-navigation -->
<div class="subnav">
  <a href="list1.html"class="active">list1 Countdown Calendar</a>
  <a href="list2.html">list2 Paperwork</a>
  <a href="list3.html">list3 Listing Planner</a>
  <a href="list4.html">list4 TradeMe</a>
  <a href="list5.html">list5</a>

</div>
<div class="container">
  <h1>Countdown to Listing</h1>
  <p class="intro">
    Use this tool to plan your selling journey. Pick your target listing date and see the key milestones to get ready on time.<br>
    <em>You can start tasks anytime — these are the last possible dates to have them finished to list by your chosen date.<br>
    Tap a milestone or orange calendar dot for explanations, tips, and checklists.</em>
  </p>
  <!-- Date input -->
  <div class="date-controls">
    <label for="listingDate"><strong>Target Listing Date:</strong></label>
    <input type="date" id="listingDate" />
    <button class="start-button" onclick="generateTimeline()">Show My Schedule</button>
  </div>
  <!-- Calendars -->
  <div id="calendar"></div>
  <!-- Milestones & explanations -->
  <div id="milestones"></div>
</div>
<script>
const tasks = [
  { name: "Declutter & Repairs", offset: 42, link: "pdfs/declutter.pdf" },
  { name: "Hire Agent & Sign Agreement", offset: 35, link: "pdfs/hire-agent.pdf" },
  { name: "Order LIM report", offset: 30, link: "pdfs/lim.pdf" },
  { name: "Get Building Inspection", offset: 28, link: "pdfs/building-inspection.pdf" },
  { name: "Schedule Photography", offset: 21, link: "pdfs/photography.pdf" },
  { name: "Draft Listing Content", offset: 18, link: "pdfs/listing-content.pdf" },
  { name: "Order Title & EQC reports", offset: 14, link: "pdfs/title-eqc.pdf" },
  { name: "Stage Property", offset: 10, link: "pdfs/staging.pdf" },
  { name: "Register on Trade Me", offset: 10, link: "pdfs/trademe.pdf" },
  { name: "Submit Trade Me Listing", offset: 7, link: "pdfs/trademe.pdf" },
  { name: "Final Checks", offset: 3, link: "pdfs/final-checks.pdf" },
  { name: "Confirm Listing Date", offset: 1, link: "pdfs/confirm-listing.pdf" }
];

function toFormattedDate(date) {
  const options = { day: 'numeric', month: 'long', year: 'numeric' };
  return date.toLocaleDateString(undefined, options);
}
function toYMD(date) {
  return [date.getFullYear(), String(date.getMonth()+1).padStart(2,'0'), String(date.getDate()).padStart(2,'0')].join('-');
}

function generateTimeline() {
  const inputDate = document.getElementById('listingDate').value;
  if (!inputDate) { alert('Please select a target listing date.'); return; }
  const listDate = new Date(inputDate);
  document.getElementById('calendar').innerHTML = '';
  document.getElementById('milestones').innerHTML = '';

  // Map: date string => array of task indices
  const taskMap = {};
  tasks.forEach((task, idx) => {
    const d = new Date(listDate);
    d.setDate(d.getDate() - task.offset);
    const dateStr = toYMD(d);
    if (!taskMap[dateStr]) taskMap[dateStr] = [];
    taskMap[dateStr].push(idx);
  });

  // Calendar for previous month
  const prevMonthDate = new Date(listDate.getFullYear(), listDate.getMonth() - 1, 1);
  // Calendar for current month
  const currentMonthDate = new Date(listDate.getFullYear(), listDate.getMonth(), 1);

  document.getElementById('calendar').innerHTML =
    `<div class="calendar">${buildCalendar(prevMonthDate, taskMap, listDate)}</div>
     <div class="calendar">${buildCalendar(currentMonthDate, taskMap, listDate)}</div>`;

  // Generate milestone buttons
  let milestoneHTML = '<h2>Milestones & Deadlines</h2><div>';
  tasks.forEach((task, idx) => {
    const date = new Date(listDate);
    date.setDate(date.getDate() - task.offset);
    const formatted = toFormattedDate(date);
    milestoneHTML += `<button class="milestone-btn" onclick="showTaskInfo(${idx})">${task.name} — ${formatted}</button>`;
  });
  milestoneHTML += '</div>';
  document.getElementById('milestones').innerHTML = milestoneHTML;
}

function buildCalendar(monthDate, taskMap, targetDate) {
  const year = monthDate.getFullYear();
  const month = monthDate.getMonth();
  const firstDay = new Date(year, month, 1);
  const startDay = firstDay.getDay();
  const daysInMonth = new Date(year, month + 1, 0).getDate();

  const options = { month: 'long', year: 'numeric' };
  const header = `<h3>${monthDate.toLocaleString('default', options)}</h3>`;
  let html = header + `<table><tr>`;
  const daysOfWeek = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  daysOfWeek.forEach(d => html += `<th>${d}</th>`);
  html += `</tr><tr>`;

  for (let i=0; i<startDay; i++) html += `<td></td>`;
  for (let d=1; d<=daysInMonth; d++) {
    const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    html += `<td><span class="date-num">${d}</span>`;
    if (taskMap[dateStr]) {
      // Only show first task dot (if multiple, could show more or tooltip)
      const idx = taskMap[dateStr][0];
      const task = tasks[idx];
      const milestoneDate = new Date(targetDate);
      milestoneDate.setDate(milestoneDate.getDate() - task.offset);
      const formatted = toFormattedDate(milestoneDate);
      html += `<div class="task-dot" tabindex="0" onclick="showTaskInfo(${idx})" title="${task.name} — ${formatted}"></div>
        <div class="dot-tooltip">${task.name}<br><b>${formatted}</b></div>
      `;
    }
    html += `</td>`;
    if ((startDay + d) % 7 === 0 && d < daysInMonth) html += `</tr><tr>`;
  }
  // fill remaining cells
  const endBlanks = (7 - ((startDay + daysInMonth) % 7)) % 7;
  for (let i=0; i<endBlanks; i++) html += `<td></td>`;
  html += `</tr></table>`;
  return html;
}

function showTaskInfo(idx) {
  // Replace this with your own modal/tooltip logic or link to PDF etc.
  const task = tasks[idx];
  let msg = `${task.name}\n\nSee explanatory PDF/checklist for tips and step-by-step help.`;
  if(task.link){
    window.open(task.link, '_blank');
  } else {
    alert(msg);
  }
}
</script>
</body>
</html>
